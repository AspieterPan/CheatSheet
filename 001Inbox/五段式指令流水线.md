---
Aliases: 
Tags: Computer/Compose 
DateCreated: 2023-08-09T14:05
DateModified: 2023-08-09T14:32
---
# 五段式指令流水线

Top:: [[Computer Compose]] - 第五章 - 中央处理器 - 5.6.3

## 运算类指令的执行过程
---
- IF：
	- 根据 PC 从指令 Cache 取指令至 IF 段的锁存器
- ID：
	- 取出操作数至 ID 段锁存器
- EX:
	- 运算,将结果存入 EX 段锁存器
- M:
	- 空段
- WB:
	- 将运算结果写回指定寄存器
 
## LOAD 指令的执行过程
---
- IF:
	- 根据 PC 从指令 Cache 取指令至 IF 段的锁存器
- ID:
	- 将基址寄存器的值放到锁存器 A 将偏移量的值放到 Imm
- EX:
	- 运算,得到有效地址
- M:
	- 从数据 Cache 中取数并放入锁存器
- WB:  
	- 将取出的数写回寄存器

> 通常,RISC 处理器只有 " 取数 LOAD" 和 " 存数 STORE " 指令才能访问主存

## STORE 指令的执行过程
---
- IF:
	- 根据 PC 从指令 Cache 取指令至 IF 段的锁存器
- ID:
	- 将基址寄存器的值放到锁存器 A,
	- 将偏移量的值放到 Imm。
	- 将要存的数放到 B
- EX:
	- 运算,得到有效地址。
	- 并将锁存器 B 的内容放到锁存器 Store。
- M:
	- 写入数据 Cache
- WB：
	- 空段

## 条件转移指令
---
- beq Rs,Rt,#偏移量
	- 若 $(Rs)==(Rt)$,则 (PC)+ 指令字长 +(偏移量×指令字长)→PC;
	- 否则 (PC)+ 指令字长→PC
 - bne Rs,Rt,#偏移量
	- 若 (Rs)!=(Rt),则 (PC)+ 指令字长 +(偏移量×指令字长)→PC;
	- 否则 (PC)+ 指令字长→PC

- IF:
	- 根据 PC 从指令 Cache 取指令至 IF 段的 锁存器
- ID:
	- 进行比较的两个数放入锁存器 A、B;
	- 偏移量放入 Imm
- EX:
	- 运算，比较两个数
- M：
	- 将目标 PC 值写回 PC
- WB：
	- 空段

## 无条件转移指令的执行过程
---
- jmp \#偏移量
	- (PC)+ 指令字长 +(偏移量×指令字长)→PC
 
- IF:
	- 根据 PC 从指令 Cache 取指令至 IF 段的锁存器
- ID:
	- 偏移量放入 Imm
- EX:
	- 将目标 PC 值写回 PC(左图没画全)
- M:
	- 空段
- WB:
	- 空段

> "WrPC 段 " 耗时比 EX 段更短,可安排 EX 段时间内完成。
> WrPC 段越早完成, 就越能避免控制冲突。
> 当然,也有的地方会在 WB 段时间内才修改 PC 的值
