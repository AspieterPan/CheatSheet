---
Aliases: 
tags: Computer/Datastructure 
DateCreated: 2023-10-05T23:08
DateModified: 2023-10-23T19:37
---
# 外部排序

Top :: [[Computer Datastructure]] - 第八章 - 排序 - 8.7.1

## 外存与内存之间的数据交换
---
- 操作系统以 " 块 " 为单位对磁盘存储空间进行管理,如: 每场大小 1KB
- 各个磁盘块内存放着各种各样的数据
- 磁盘的读/写以 " 块 " 为单位
	- 数据读入内存后才能被修改
	- 修改完了还要写回磁盘

## 外部排序的原理
---
- 外部排序:
	- 数据元素太多,无法一次全部读入内存进行排序
	- 使用 " 归并排序 " 的方法,
		- 最少只需在内存中分配 3 块大小的缓冲区
			- 两个输入缓冲区
			- 一个输出缓冲区
			- 即可对任意一个大文件进行排序
		- 归并排序的步骤:
			- 根据缓冲区大小, 将上的文件分成若干长度为 $l$ 的子文件
				- 依次读入内存并利用内部排序方法对它们进行排序,
				- 并将排序后得到的有序子文件重新写回外存
			- 对这些归并段进行逐趟归并,
				- 归并步骤:
					- 先取两个归并段的第一个块到缓冲区, 进行归并
						- 归并的结果放回到磁盘中
					- 哪一个缓冲区空了, 就用对应归并段的下一块补上
				- 使归并段 (有序子文件) 逐渐由小到大,
				- 直到得到整个有序文件为止
   
## 影响外部排序效率的因素
---
- 外部排序时间开销=读写外存的时间 + 内部排序所需时间 + 内部归并所需时间
	- 主要是读写外存的时间

## 优化思路
---
- 多路归并:
	- 输入缓冲区不止两个, 而是更多个
		- k(路) 越大, r(初始段) 越小, 归并趟数越少, 读写磁盘次数越少
	- 多路归并带来的负面影响:
		1. k 路归并时,需要开辟 k 个输入缓冲区,内存开销增加。
		2. 每挑选一个关键字需要对比关键字 (k-1) 次,内部归并所需时间增加
