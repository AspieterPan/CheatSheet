---
Aliases: 
tags: 计算机/组成原理 
DateCreated: 2023-08-10T21:26
DateModified: 2023-08-10T21:59
---
# 总线操作和定时

Top:: [[王道 - 计算机组成原理]] - 第六章 - 总线 - 6.3

## 总线传输的四个阶段
---
1. 申请分配阶段
	- 由需要使用总线的主模块 (或主设备) 提出出申请,经总线仲裁机构决定将下一传输周期的总线使用权授予某一申请者。也可将此阶段细分为==传输请求==和==总线仲裁==两个阶段。
2. 寻址阶段
	- 获得使用权的主模块通过总线发出本次要访问的从模块的==地址及有关命令==,启动参与本次传输的从模块。
3. 3) 传输阶段
	- 主模块和从模块进行==数据交换==,可单向或双向进行数据传送。
4. 4) 结束阶段
	- 主模块的有关信息均从系统总线上==撤除==,让出总线使用权。
- 总线定时
	- 是指总线在双方交换数据的过程中需要时间上配合关系的控制,这种控制称为总线定时,
		- 它的实质是一种协议或规则
	- 同步通信 (同步定时方式)
		- 由统一时钟控制数据传送
	- 异步通信 (异步定时方式)
		- 采用应答方式,没有公共时钟标准
	- 半同步通信
		- 同步、异步结合
	- 分离式通信
		- 充分挖掘系统总线每瞬间的潜力

## 同步定时方式
---
- 同步定时方式是指系统采用一个统一的时钟信号来协调发送不和接收双方的传送定时关系。
	- 若干个时钟产生相等的时间间隔,每个间隔构成一个总线我周期
	- 在一个总线周期中,发送方和接收方可进行一次数据传送卷。
	- 因为采用统一的时钟,每个部件或设备发送或接收信息都在固定的总线传送周期中,一个总线的传送周期结束,下一个总线传送周期开始。
- 优点:
	- 传送速度快,具有较高的传输速率; 总线控制逻辑简单
- 缺点:
	- 主从设备属于强制性同步; 不能及时进行数据通信的有效性检验,可靠性较差。
- 同步通信适用于==总线长度较短==及总线所接部件的存取时间==比较接近==的系统。

### 同步定时方式 - 读命令

- 总线控制器采用一个统一的时钟信号来协调发送和接收双方的传送定时关系。
- 假设:CPU 作为主设备,某个输入设备作为从设备
	1. CPU 在 T1 时刻的上升沿给出地址信息
	2. 在 T2 的上升沿给出读命令 (低电平有效),与地址信息相符合的输入设备按命令进行一系列的内部操作,且必须在 T3 的上升沿来之前将 CPU 所需的数据送到数据总线上。
	3. CPU 在 T3 时钟周期内,将数据线上的信息传送到其内部寄存器中。
	4. CPU 在 T4 的上升沿撤销读命令,输入设备不再向数据总线上传送数据,撤销它对数据总线的驱动。

> [!note] 上升沿 和 下降沿
> 上升沿：数字电平从 0 变为 1 的一瞬间
> 下降沿：数字电平从 1 变为 0 的一顺间

## 异步定时方式
---
- 在异步定时方式中,没有统一的时钟,也没有固定的时间门同隔,完全依靠传送双 方相互制约的 " 握手 " 信号来实现定时控制。
- 主设备提出交换信息的 " 请求 " 信号,经接口传送到从设备备; 从设备接到主设备 的请求后,通过接口向主设备发出 " 回答 " 信号。
- 优点:
	- 总线周期长度可变,能保证两个工作速度相差很大的部都件或设备之间可靠地进行信息交换,自动适应时间的配合。
- 缺点:
	- 比同步控制方式稍复杂一些,速度比同步定时方式式慢。

- 根据 " 请求 " 和 " 回答 " 信号的撤销是否互锁,分为以下 3 种类型。
	1. 不互锁方式
		- 主设备发出 " 请求 " 信号后,不必等到接到从设备的 " 回答 " 信号,而是经过一段时间,便撤销 " 请求 " 信号。而从设备在接到 " 请求 " 信号后,发出 " 回答 " 信号,并经过一段时间,自动撤销 " 回答 " 信号。双方不存在互锁关系。
	2. 半互锁方式
		- 主设备发出 " 请求 " 信号后,必须待接到从设备的 " 回答 " 信号后,才撤销 " 请求 " 信号,有互锁的关系。而从设备在接到 " 请求 " 信号后,发出 " 回答 " 信号,但不必等待获知主设备的 " 请求 " 信号已经撤销,而是隔一段时间后自动撤销 " 回答 " 信号,不存在互锁关系。
	3. 全互锁方式
		- 主设备发出 " 请求 " 信号后,必须待从设备 " 回答 " 后,才撤销 " 请求 " 信号;
		- 从设备发出 " 回答 " 信号,必须待获知主设备 " 请求 " 信号已撤 销后,再撤销其 " 回答 " 信号。双方存在互锁关系。

## 半同步通信
---
- 同步
	- 发送方用系统时钟前沿发信号
	- 接收方用系统时钟后沿判断、识别
- 异步
	- 允许不同速度的模块和谐工作
- 半同步通信
	- 统一时钟的基础上,增加一个 " 等待 " 响应信号 $\overline{WAIT}$

## 分离式通信
---
- 上述三种通信的共同点
	- 一个总线传输周期 (以输入数据为例)
		- 主模块发地址、命令
			- 使用总线
		- 从模块准备数据
			- 不使用总线 (总线空闲)
		- 从模块向主模块发数据
			- 使用总线
- 分离式通信的一个总线传输周期
	- 子周期 1
		- 主模块申请占用总线,使用完后放弃总线的使用权
	- 子周期 2
		- 从模块申请占用总线,将各种信息送至总线上
- 特点:
	1. 各模块均有权申请占用总线
	2. 采用同步方式通信,不等对方回答
	3. 各模块准备数据时,不占用总线
	4. 总线利用率提高
